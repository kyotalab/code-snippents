---
id: 20250806034838
title: Rust aws_sdk_ec2を使ったdescribe_security_groups
type: infrastructure
tags: [rust, aws_sdk_ec2, describe_security_groups]
created: 2025-08-06 03:48:38
updated: 2025-08-06 03:59:20
---

## Rust aws_sdk_ec2を使ったdescribe_security_group

### Code Snippet

```rust
use aws_sdk_ec2 as ec2;

#[::tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    let config = aws_config::load_from_env().await;
    let client = ec2::Client::new(&config);

    // 空のVecを渡すと全てのセキュリティグループを取得
    describe_security_groups(&client, vec![]).await;
    Ok(())
}


async fn describe_security_groups(client: &aws_sdk_ec2::Client, group_ids: Vec<String>) {
    let response = client
        .describe_security_groups()
        .set_group_ids(Some(group_ids))
        .send()
        .await;

    match response {
        Ok(output) => {
            for group in output.security_groups() {
                println!(
                    "Found Security Group {} ({}), vpc id {} and description {}",
                    group.group_name().unwrap_or("unknown"),
                    group.group_id().unwrap_or("id-unknown"),
                    group.vpc_id().unwrap_or("vpcid-unknown"),
                    group.description().unwrap_or("(none)")
                );
            }
        }
        Err(err) => {
            eprintln!("Error listing EC2 Security Groups: {:?}", err);
        }
    }
}
```

---

### Points

- 空のVecを渡すと全てのセキュリティグループを取得
- Debugトレイト `{:?}` を使用して詳細情報を出力
- `Box<dyn std::error::Error>` を使用して他のライブラリ空のエラー（設定読み込み、ファイルI/Oなど）も受け入れ可能にする

---

### 実行速度

```bash
# コンパイル込み
$ time cargo run
   Compiling aws-operations v0.1.0 (/Users/nakadakyota/languages/rust/aws-operations)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 7.58s
     Running `target/debug/aws-operations`
Found Security Group default (sg-056e444c1891b25f7), vpc id vpc-0c896a4cf4a0ea47e and description default VPC security group
Found Security Group launch-wizard-1 (sg-0aa114dbcfa7f4094), vpc id vpc-0c896a4cf4a0ea47e and description launch-wizard-1 created 2025-06-23T19:28:45.143Z
Found Security Group launch-wizard-2 (sg-09e4b82ddc89e99a7), vpc id vpc-0c896a4cf4a0ea47e and description launch-wizard-2 created 2025-06-23T19:39:03.390Z
cargo run  0.38s user 0.24s system 6% cpu 8.887 total

# 事前コンパイル
$ time ./target/release/aws-operations
Found Security Group default (sg-056e444c1891b25f7), vpc id vpc-0c896a4cf4a0ea47e and description default VPC security group
Found Security Group launch-wizard-1 (sg-0aa114dbcfa7f4094), vpc id vpc-0c896a4cf4a0ea47e and description launch-wizard-1 created 2025-06-23T19:28:45.143Z
Found Security Group launch-wizard-2 (sg-09e4b82ddc89e99a7), vpc id vpc-0c896a4cf4a0ea47e and description launch-wizard-2 created 2025-06-23T19:39:03.390Z
./target/release/aws-operations  0.18s user 0.03s system 18% cpu 1.109 total
```

---

### References

- [https://github.com/awslabs/aws-sdk-rust/blob/main/examples/examples/ec2/src/bin/ec2-helloworld.rs#L22](https://github.com/awslabs/aws-sdk-rust/blob/main/examples/examples/ec2/src/bin/ec2-helloworld.rs#L22)
- [https://docs.rs/aws-sdk-ec2/latest/aws_sdk_ec2/](https://docs.rs/aws-sdk-ec2/latest/aws_sdk_ec2/)
- [https://docs.rs/aws-sdk-ec2/latest/aws_sdk_ec2/struct.Client.html#method.describe_security_groups](https://docs.rs/aws-sdk-ec2/latest/aws_sdk_ec2/struct.Client.html#method.describe_security_groups)
- [https://docs.rs/aws-sdk-ec2/latest/aws_sdk_ec2/operation/describe_security_groups/builders/struct.DescribeSecurityGroupsFluentBuilder.html](https://docs.rs/aws-sdk-ec2/latest/aws_sdk_ec2/operation/describe_security_groups/builders/struct.DescribeSecurityGroupsFluentBuilder.html)
- [https://docs.rs/aws-sdk-ec2/latest/aws_sdk_ec2/operation/describe_security_groups/struct.DescribeSecurityGroupsOutput.html](https://docs.rs/aws-sdk-ec2/latest/aws_sdk_ec2/operation/describe_security_groups/struct.DescribeSecurityGroupsOutput.html)
- [https://docs.rs/aws-sdk-ec2/latest/aws_sdk_ec2/types/struct.SecurityGroup.html](https://docs.rs/aws-sdk-ec2/latest/aws_sdk_ec2/types/struct.SecurityGroup.html)
