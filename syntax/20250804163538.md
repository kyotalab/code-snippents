---
id: 20250804163538
title: RustでJSONファイルのデシリアライズ処理のミニマム実装
type: syntax
tags: [rust, json, serde, deserialize, file-io]
created: 2025-08-04 16:35:38
updated: 2025-08-04 16:39:21
---

## RustでJSONファイルのデシリアライズ処理のミニマム実装

### Code Snippet

**Input JSON**

```json
[
  {
    "date": "2024-01-15",
    "product": "Laptop",
    "category": "Electronics",
    "amount": 1200,
    "quantity": 1,
    "region": "North",
    "salesperson": "Alice"
  },
  {
    "date": "2024-01-15",
    "product": "Mouse",
    "category": "Electronics",
    "amount": 25,
    "quantity": 3,
    "region": "South",
    "salesperson": "Bob"
  },
  {
    "date": "2024-01-16",
    "product": "Desk",
    "category": "Furniture",
    "amount": 300,
    "quantity": 2,
    "region": "North",
    "salesperson": "Alice"
  },
  {
    "date": "2024-01-16",
    "product": "Chair",
    "category": "Furniture",
    "amount": 150,
    "quantity": 4,
    "region": "South",
    "salesperson": "Carol"
  }
]
```

```rust
use std::fs;
use serde::Deserialize;
use chrono::NaiveDate;

fn main() -> Result<(), Box<dyn std::error::Error>> {
    let path = "sales.json";
    let json = fs::read_to_string(path)?;
    let sales: Vec<Sale> = serde_json::from_str(&json)?;

    // より詳細な出力
    println!("Loaded {} sales records:", sales.len());
    for sale in &sales {
        println!("{:#?}", sale);
    }

    Ok(())
}

#[derive(Debug, Deserialize)]
pub struct Sale {
    pub date: NaiveDate,
    pub product: String,
    pub category: String,
    pub amount: u32,    // 負の金額を防ぐ
    pub quantity: u32,  // 負の数量を防ぐ
    pub region: String,
    pub salesperson: String,
}
```

---

### Points

1. `println!("{:#?}", sale)` でより読みやすい出力
2. ミニマム構成ならanyhowは過剰なため不要
3. 実用では、フィールドの型に `&str`, `enum型` を使用する

---

### Dependencies

2025-08-04（現在）

```toml
chrono = { version = "0.4.41", features = ["serde"] }
serde = { version = "1.0.219", features = ["derive"] }
serde_json = "1.0.142"
```

---

### Related Notes

- [RustでYAMLファイルのデシリアライズ処理のミニマム実装](./20250804171533.md) - 同じ構造体を使用
