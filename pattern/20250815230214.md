---
id: 20250815230214
title: テスタブルな設計パターン
type: pattern
tags:
  [testing, testable-design, mocking, depencency-injection, go, unit-testing]
created: 2025-08-15 23:02:14
updated: 2025-08-15 23:08:46
---

## テスタブルな設計パターン

### Core Concept

依存関係の注入とインターフェースの活用により、ユニットテストが容易な設計を実現する。

---

### インターフェース設計

```go
// テスト可能な抽象化
type TodoRepository interface {
    Save(todo *Todo) error
    FindById(id int) (*Todo, error)
}

type IdGenerator interface {
    Generate() (int, error)
}
```

---

### モック実装

```go
// テスト用モック
type MockTodoRepository struct {
    todos map[int]*Todo
}

func (m *MockTodoRepository) Save(todo *Todo) error {
    m.todos[todo.Id] = todo
    return nil
}
```

---

### テスト実装例

```go
func TestAddTodo_Success(t *testing.T) {
    // Given
    mockRepo := &MockTodoRepository{todos: make(map[int]*Todo)}
    mockIdGen := &MockIdGenerator{nextId: 1}
    service := NewTodoApplicationService(mockRepo, mockIdGen)

    // When
    todo, err := service.AddTodo(AddTodoInput{Title: "test"})

    // Then
    assert.NoError(t, err)
    assert.Equal(t, 1, todo.Id)
}
```

---

### Related Notes

- [Repositoryパターンの実装](./20250815172501.md)
- [Dependency Injection in Go](./20250815173055.md)
